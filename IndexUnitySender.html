
<span onclick="OpenReceiverWindow()">open new window</span>
<script>
  //listens to message that connection is established
  window.addEventListener('message', OnPresentationWindowLoaded, false);



  var ReceiverWindow;
  var msg = "no message";
  var windowReady = false;

  //receives message that connection to presentation window has been achieved
  function OnPresentationWindowLoaded(){
    console.log("received message " + event.data);
    Post();
  }

  //opens the presentation window
  function OpenReceiverWindow(){
    if(!ReceiverWindow){
      console.log("Receiver window undefined");
      ReceiverWindow = window.open("https://anerainteractive.github.io/UnityWebGLReceiver/index.html");
      console.log("opened new window: " + ReceiverWindow);
      windowReady = true;
    }
  }

  //receives message from the unity build
  function ReceiveMessage(pMsg){
    msg = pMsg;
    if(windowReady){
      Post();
    }
  }

  //posts message to presentation window
  function Post(){
    console.log(msg);
    ReceiverWindow.postMessage(msg, "https://anerainteractive.github.io/UnityWebGLReceiver/index.html");
    console.log("Sent message " + msg);
    // document.getElementById("log").innerText = "";
    // document.getElementById("log").innerText = msg;
  }
</script>